import{p as A}from"./@babel-beed5cd7.js";import{j as b,u as h,b as T,a as l,c as B,h as n,l as I,L as J}from"./pl-react-3e11a3c7.js";import{C as K,a as O,s as P,d as W,b as Y,c as _}from"./index-05508ba8.js";import{D as z}from"./basic-fc70e6c7.js";import{C as G,t as H,a as Q,b as X}from"./source-af657fce.js";import"./debug-ddf39923.js";import"./ms-f6814399.js";import"./globals-aa9f7777.js";import"./@jridgewell-330284f4.js";import"./jsesc-4cfd8464.js";import"./picocolors-cddfbdbe.js";import"./js-tokens-bc2e8ff2.js";import"./marked-4b92e03d.js";const Z="page-utils-f86c23",tt="navigation-62969b",et="content-bea58d",nt="outline-690e4e",st="total-307071",f={"page-utils":"page-utils-f86c23",pageUtils:Z,navigation:tt,content:et,outline:nt,total:st};const ht=F=>{const S=b(W),[g,L]=h([]),[p,R]=h({name:"",content:""}),U=T(Q,[]);async function N(t){const{keys:e,body:o}=await U;!g.length&&L(e);const s=e.find(i=>i===t)||e[0];let r=o[s];S.state.codeLanguage==="js"&&(r=H(r)),R({name:s,content:r})}const y=I(),[$,V]=h(!0);l(()=>{if($){V(!1);return}const t=y.current.path+".ts";N(t)},[S.state.codeLanguage]);const c=T(()=>{const t=A(p.content,{sourceType:"module",plugins:["typescript"]});function e(a){const s={start:null,title:null};if(!a)return s;const r=a[a.length-1],{type:i,value:u,loc:d}=r;if(s.start=d.start.line,i==="CommentBlock"){const m=u.match(/\*(.)+(\n|\r\n)/);if(!m)return s;s.title=m[0].replace(/\*/g,"").trim()}else s.title=u.replace(/\/\//,"").trim();return s}const o=[];for(const a of t.program.body)if(a.type==="ExportNamedDeclaration"){if(["FunctionDeclaration","ClassDeclaration"].includes(a.declaration.type)){const{loc:s,declaration:r,leadingComments:i}=a,{start:u,end:d}=s,{start:m,title:C}=e(i);o.push({start:u.line,end:d.line,name:r.id.name,title:C,commentStart:m})}}else if(a.type==="FunctionDeclaration"){const{loc:s,id:r,leadingComments:i}=a,{start:u,end:d}=s,{start:m,title:C}=e(i);o.push({start:u.line,end:d.line,name:r.name,title:C,commentStart:m})}return o},[p.content]);l(()=>y.monitor(async(t,e)=>{if(!t.path.startsWith(F.path))return;const o=t.path+".ts";N(o)}),[]),l(()=>{if(!c.length)return;const t=y.current.query.name;if(!t)return;const e=c.find(o=>o.name===t);e&&setTimeout(()=>{w(e.commentStart)})},[c]);const k=B();function w(t){const e=k.current.getEl().getElementsByClassName("row-num")[0].childNodes;for(const o of e)if(o.getElementsByTagName("label")[0].textContent===t+""){P(o);break}}const E=()=>n("ul",{className:f.navigation},...g.map(t=>{const e=t.split("/")[2].replace(".ts","");return n("li",null,n(J,{to:t.split(".")[0]},e))})),x=b(Y);l(()=>{g.length&&x.dispatch({type:"menuSet",payload:E()})},[g]),l(()=>()=>{x.dispatch({type:"menuClear"})},[]),l(()=>{const t="$utils";return window[t]=X(),()=>{delete window[t]}},[]);const[j,q]=h(!1),v=B(),M=(()=>{const t=p.name.split("/")[2];return t?"$utils."+t.replace(".ts",""):"$utils."})(),D=b(_);return l(()=>{const t=Symbol("utilsConsole"),e={id:t,btn:n("div",{onclick:()=>q(!0)},"C"),layer:2};return D.dispatch({type:"btnAdd",payload:e}),()=>{D.dispatch({type:"btnRemove",payload:t})}},[]),n(O,{className:f.pageUtils},n("aside",null,E()),n("section",{className:f.content},n(K,{ref:k,value:p.content,lines:c})),n("aside",{className:f.outline},n("ul",null,...c.map(t=>n("li",{className:"text-ellipsis",onclick:()=>{w(t.commentStart||t.start),y.replace({path:p.name.replace(".ts",""),query:{name:t.name}})}},t.title||t.name))),n("div",{className:f.total},"total: ",c.length)),n(z,{open:j,onClose:()=>{v.current.clear(),q(!1)},style:"width: 500px"},n(G,{ref:v,value:M})))};export{ht as default};
