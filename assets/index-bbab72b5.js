import{p as R}from"./@babel-cd739a4a.js";import{c as w,e as U,m as D,h as l,o as L,f as S,u as T,L as _,i as q}from"./pl-react-f16e3da5.js";import{C as A,d as B,b as $,t as j,s as H,e as J}from"./source-039eda11.js";import{s as M}from"./index-bed6cbd5.js";import"./debug-ddf39923.js";import"./ms-f6814399.js";import"./globals-aa9f7777.js";import"./@jridgewell-228fcee0.js";import"./jsesc-4cfd8464.js";import"./picocolors-cddfbdbe.js";import"./js-tokens-bc2e8ff2.js";function*V(p){for(const d of p)yield d}function W(p){const{lines:d,value:f,defaultUnfold:E,...y}=p,c=`
`,h=f.replace(/\r/g,"").split(c),[i,k]=w([]);U(()=>{function n(s,t){return L(s,e=>{const a=e.start-1,u=[];t.push({start:a,end:e.end-1,source:h.slice(a,e.end).join(c),target:h[a]+" ...",children:n(e.children||[],u),unfold:e.unfold??!!E})}),t}k(n(d,[]))},[f,d]);const{content:C,rows:x}=D(()=>{const n=[];let s=0;function t(a,u){let r="";if(!a.length)return u;const m=V(a);let o=m.next().value;return L(h,(F,g)=>{if(!o){r+=F+c,n.push({key:s,fold:0}),s++;return}g>o.start&&g<o.end+1||(g<o.start?(r+=F+c,n.push({key:g,fold:0})):g>o.end?(r+=F+c,o=m.next().value,n.push({key:g,fold:0})):(o.unfold?(r+=t(o.children,o.source+c),L(new Array(o.end-o.start+1),(Q,I)=>{n.push({key:s+I,fold:I===0?2:0})})):(r+=o.target+c,n.push({key:o.start,fold:1})),s=o.end),s++)}),r}return{content:t(i,f).slice(0,-1),rows:n}},[i]);function N(n){const s=i.findIndex(e=>e.start===n),t=B(i);t[s].unfold=!i[s].unfold,k(t)}function v(n){const s=x[n]||{key:n,fold:0},t={0:"",1:"unfold",2:"fold"};return l("div",null,l("label",null,s.key+1),l("span",{className:t[s.fold],onclick:s.fold?()=>N(s.key):null}))}return l(A,{value:i.length?C:f,...y,slotRowItem:v,className:["br-code-edit-fold",...[p.className].flat()]})}const z="page-utils-f86c23",G="navigation-62969b",K="content-bea58d",O="outline-690e4e",P="total-307071",b={"page-utils":"page-utils-f86c23",pageUtils:z,navigation:G,content:K,outline:O,total:P},ct=p=>{const[d]=S(M),[f,E]=w([]),[y,c]=w(""),h=D(J,[]);async function i(t){const{keys:e,body:a}=await h;!f.length&&E(e);const u=e.find(m=>m===t);let r=a[u||e[0]];d.codeLanguage==="js"&&(r=j(r)),c(r)}const k=q();U(()=>k.monitor(async t=>{if(!t.path.startsWith(p.path))return;const e=t.path+".ts";i(e)}),[]);const[C,x]=w(!0);U(()=>{if(C){x(!1);return}const t=k.current.path+".ts";i(t)},[d.codeLanguage]);const N=D(()=>{const t=R(y,{sourceType:"module",plugins:["typescript"]}),e=[];for(const a of t.program.body)if(a.type==="ExportNamedDeclaration"&&["FunctionDeclaration","ClassDeclaration"].includes(a.declaration.type)){const{loc:u,declaration:r}=a,{start:m,end:o}=u;e.push({start:m.line,end:o.line,name:r.id.name})}return e},[y]),v=new $({keywords:["import","export","default","from","const","let","var","function","this","arguments","return","eval","class","constructor","new","extends","super","async","await","yield","if","else","switch","case","try","catch","finally","throw","for","in","of","while","do","break","continue","debugger","delete","typeof","void","instanceof","true","false","null","undefined","NaN","Infinity"]}),n=T();function s(t){const e=n.current.getEl().getElementsByClassName("row-num")[0].childNodes;for(const a of e)if(a.getElementsByTagName("label")[0].textContent===t+""){H(a);break}}return l("div",{className:b.pageUtils},l("aside",{className:b.navigation},l("ul",null,...f.map(t=>{const e=t.split("/")[2].replace(".ts","");return l("li",null,l(_,{to:t.split(".")[0]},e))}))),l("section",{className:b.content},l(W,{ref:n,value:y,lines:N,toHtml:t=>v.output(t),isEdit:!1})),l("aside",{className:b.outline},l("ul",null,...N.map(t=>l("li",{onclick:()=>s(t.start)},t.name))),l("div",{className:b.total},"total: ",N.length)))};export{ct as default};
